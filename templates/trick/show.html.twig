{% extends 'base.html.twig' %}

{% block title %}Tricks
{% endblock %}
{% block metaName %}SnowTricks Listes des Tricks
{% endblock %}
{% block metaContent %}Listes des Tricks
{% endblock %}

{% block body %}

{# TODO La page ne doit s'afficher que si le trick.publish = 1 #}
   
{# TODO Mettre une image de fond sur toute la largeur de la page #}

{# TODO Mettre l'image à la une = principale ou image par défaut #}
<div class="container my-5 px-auto border">
    
    <div class="row"> {# TODO Mise en page #}
        <div class="col-10">
            <h1>{{ trick.title | upper }}</h1>
        </div>
        {% if is_granted('ROLE_USER') %} {# les boutons edit and delete ne sont affichés que si l'utilisateur est connecté #}
        <div class="col-1">
            <a href="{{ path('trick_edit', {'id': trick.id}) }}">
                <button><i class="far fa-edit"></i></button>
            </a>
        </div>    
        <div>    
            {{ include('trick/_delete_form.html.twig') }}
        </div>     
        {% endif %}
    </div>         

    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel"> {# TODO figer la hauteur du carrousel #}
    <div class="carousel-inner">
        {% for image in trick.images %} 
        <div class="carousel-item {% if loop.index == 1 %} active {% endif %}">
            <img class="d-block w-100" src="{{ image.src }}" alt="">
        </div>
        {% endfor %}
    </div>

    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    </div>
</div>

{# TODO Afficher gallery avec les photos et les vidéos à la suite #}    
{# TODO  Galerie : Sur mobile, elle sera caché avec un bouton qui permettre de déployer une liste contenant les images et les vidéos #}

    <div class="container border my-5">
        <p>Créé le  <b>{{ trick.createdAt ? trick.createdAt|date('Y-m-d H:i:s') : '' }} </b></p> 
        {% if trick.editedAt %} <p>Modifé le <b> {{ trick.editedAt ? trick.editedAt|date('Y-m-d H:i:s') : '' }}</b> </p> {% endif %} {# Filtre : Afficher "Modifié le" seulement si editAt exist s'il existe #}
        <p>Dans la catégorie {% for category in trick.category %} {{ category.title }}  {% endfor %}{# TODO Afficher la catégorie #}</p>



        <hr class="my-1">

        <p>Description = <b>{{ trick.description }}</b></p>
    </div>

    <div class="container my-5 px-auto border">
         {% if is_granted('ROLE_USER') %} {# Le formulaire n'est affiché que si l'utilisateur est connecté #}
        <button class="btn-info">Ajout un commentaire</button> {# TODO le formulaire d'ajout commentaire #}
        {% else %}
        <a href="{{ path('login') }}"><button class="btn-info">Vous voulez laisser un commentaire : Connectez-vous</button></a>
        {% endif %}
        
        {# TODO mise en page block commentaire #}
        {% for comment in trick.comments %} 
            <div>
                posté le {{ comment.createdAt ? comment.createdAt|date('Y-m-d') : '' }} par  {% for user in comment.user %} {{ user.username }}  {% endfor %} {# TODO Afficher pseudo #}
            </div>
            <div>
                {{ comment.content }}
            </div>    
        {% endfor %}
        {# TODO  pagination commentaire #}
    </div>

</div>   
   
{% endblock %}

